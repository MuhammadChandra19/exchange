version: v1
managed:
  enabled: true
  go_package_prefix:
    default: github.com/muhammadchandra19/exchange/proto/go

plugins:
  # Go protobuf generation
  - plugin: buf.build/protocolbuffers/go
    out: go
    opt: 
      - paths=source_relative

  # Go gRPC generation
  - plugin: buf.build/grpc/go
    out: go
    opt: 
      - paths=source_relative

  # gRPC-Gateway (for all modules - we'll filter manually)
  - plugin: buf.build/grpc-ecosystem/gateway
    out: go
    opt:
      - paths=source_relative
      - allow_delete_body=true

  # OpenAPI generation (for all modules - we'll filter manually)
  # - plugin: buf.build/grpc-ecosystem/openapiv2
  #   out: openapi
  #   opt:
  #     - logtostderr=true
  #     - generate_unbound_methods=true
  #     - allow_merge=true
  #     - merge_file_name=api
  #     - allow_delete_body=true
  #     - include_package_in_tags=true  
  #   # include:
    #   - modules
    # exclude:
    #   - modules/*/v*/private
    #   - modules/*/v*/shared
    #   - core/*

  # TypeScript generation
  - plugin: buf.build/connectrpc/es
    out: ts
    opt: 
      - target=ts
      - import_extension=none

  # TypeScript types
  - plugin: buf.build/bufbuild/es  
    out: ts
    opt:
      - target=ts
      - import_extension=none